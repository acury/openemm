<?xml version="1.0" encoding="UTF-8"?>
<!--
	Application context definition for AGNITAS service layer.

	Only service layer classes here!
-->
<beans
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans
		http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context
		http://www.springframework.org/schema/context/spring-context.xsd
		http://www.springframework.org/schema/util
		http://www.springframework.org/schema/util/spring-util-2.5.xsd
		http://www.springframework.org/schema/aop
		http://www.springframework.org/schema/aop/spring-aop.xsd">

	<context:component-scan base-package="org.agnitas, com.agnitas">
		<context:exclude-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
		<context:exclude-filter type="annotation" expression="org.springframework.web.bind.annotation.ControllerAdvice"/>
	</context:component-scan>


<!-- ============================================================================================================================== Access data -->
	<bean id="AccessDataService" class="com.agnitas.emm.core.mobile.service.impl.ComAccessDataServiceImpl">
		<property name="accessDataDao" ref="ComAccessDataDao" />
	</bean>


<!-- ============================================================================================================================== Admin & preferences -->
	<bean id="AdminService" class="com.agnitas.emm.core.admin.service.impl.AdminServiceImpl">
		<property name="adminDao" ref="AdminDao" />
		<property name="supervisorDao" ref="SupervisorDao" />
		<property name="supervisorService" ref="SupervisorService" />
		<property name="companyDao" ref="CompanyDao"/>
		<property name="adminPreferencesDao" ref="AdminPreferencesDao"/>
		<property name="adminGroupDao" ref="AdminGroupDao"/>
		<property name="grantedSupervisorLoginDao" ref="GrantedSupervisorLoginDao" />
		<property name="configService" ref="ConfigService" />
        <property name="permissionFilter" ref="PermissionFilter"/>
        <property name="emmLayoutBaseDao" ref="EmmLayoutBaseDao"/>
        <property name="permissionService" ref="PermissionService"/>
        <property name="adminPasswordChangedNotifier">
        	<bean class="com.agnitas.emm.core.admin.service.impl.MailAdminPasswordChangedNotifier">
        		<constructor-arg ref="JavaMailService" />
				<constructor-arg ref="ConfigService" />
			</bean>
        </property>
    </bean>
    
	<bean id="UserGroupService" class="com.agnitas.emm.core.usergroup.service.impl.UserGroupServiceImpl">
		<property name="userGroupDao" ref="AdminGroupDao" />
		<property name="companyService" ref="ComCompanyService" />
		<property name="conversionService" ref="conversionService" />
		<property name="permissionFilter" ref="PermissionFilter" />
		<property name="permissionService" ref="PermissionService" />
    </bean>
    
    <bean id="SalutationService" class="com.agnitas.emm.core.salutation.service.impl.SalutationServiceImpl">
   		<property name="titleDao" ref="TitleDao" />
    </bean>

	<bean id="adminChangesLogService" class="com.agnitas.emm.core.admin.service.impl.AdminChangesLogServiceImpl">
		<property name="adminService" ref="AdminService" />
	</bean>

	<bean id="AdminGroupService" class="com.agnitas.emm.core.admin.service.impl.AdminGroupServiceImpl">
		<property name="adminGroupDao" ref="AdminGroupDao" />
	</bean>

    <bean id="WebStorage" class="com.agnitas.service.impl.ComWebStorageImpl" scope="session" lazy-init="true">
        <aop:scoped-proxy/>
    </bean>

	<bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
		<property name="targetClass" value="org.apache.commons.lang3.ClassUtils"/>
		<property name="targetMethod" value="getClass"/>
		<property name="arguments">
			<list>
				<value type="java.lang.String">org.agnitas.service.WebStorage</value>
				<value type="java.lang.Boolean">true</value>
			</list>
		</property>
	</bean>

	<bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
		<property name="targetClass" value="org.apache.commons.lang3.ClassUtils"/>
		<property name="targetMethod" value="getClass"/>
		<property name="arguments">
			<list>
				<value type="java.lang.String">com.agnitas.service.ComWebStorage</value>
				<value type="java.lang.Boolean">true</value>
			</list>
		</property>
	</bean>

<!-- ============================================================================================================================== RecipientsReport -->
	<bean id="RecipientsReportService" class="com.agnitas.emm.core.recipientsreport.service.impl.RecipientsReportServiceImpl">
		<property name="recipientsReportDao" ref="RecipientsReportDao" />
        <property name="mimeTypeService" ref="MimeTypeService"/>
    </bean>

<!-- ================================================================================ Auto optimization -->
	<bean id="optimizationCommonService" class="com.agnitas.mailing.autooptimization.service.impl.ComOptimizationCommonServiceImpl">
		<property name="maildropStatusDao" ref="MaildropStatusDao" />
		<property name="optimizationDao" ref="OptimizationDao" />
		<property name="mailingDao" ref="MailingDao" />
	</bean>

	<bean id="OptimizationStatService" class="com.agnitas.mailing.autooptimization.service.impl.ComOptimizationStatServiceImpl">
		<property name="statDao" ref="StatDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="comCompanyDao" ref="BirtCompanyDao" />
	</bean>

	<bean id="optimizationService" class="com.agnitas.mailing.autooptimization.service.impl.ComOptimizationServiceImpl">
		<property name="optimizationDao" ref="OptimizationDao" />
		<property name="targetDao" ref="TargetDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="optimizationCommonService" ref="optimizationCommonService" />
		<property name="optimizationStatService" ref="OptimizationStatService" />
		<property name="mailingParameterService" ref="MailingParameterService" />
		<property name="copyMailingService" ref="CopyMailingService" />
	</bean>

	<bean id="optimizationScheduleService" class="com.agnitas.mailing.autooptimization.service.impl.ComOptimizationScheduleServiceImpl">
		<property name="mailingDao" ref="MailingDao" />
		<property name="optimizationCommonService" ref="optimizationCommonService" />
		<property name="targetDao" ref="TargetDao" />
		<property name="maildropService" ref="MaildropService" />
	</bean>

<!-- ============================================================================================================================== Binding -->
	<bean id="BindingService" class="com.agnitas.emm.core.binding.service.impl.ComBindingServiceImpl" >
		<property name="bindingEntryDao" ref="BindingEntryDao" />
		<property name="mailinglistDao" ref="MailinglistDao" />
		<property name="recipientDao" ref="RecipientDao" />
		<property name="bindingEntryFactory" ref="BindingEntryFactory" />
		<property name="mailingDao" ref="MailingDao" />
	</bean>

	<bean id="bindingBulkService" class="org.agnitas.emm.core.binding.service.impl.BindingBulkServiceImpl">
		<property name="bindingService" ref="BindingService" />
		<property name="bindingEntryDao" ref="BindingEntryDao" />
	</bean>

<!-- ============================================================================================================================== Blacklist -->
	<bean id="BlacklistService" class="org.agnitas.emm.core.blacklist.service.impl.BlacklistServiceImpl">
		<property name="blacklistDao" ref="BlacklistDao" />
		<property name="bindingService" ref="BindingService" />
		<property name="conversionService" ref="conversionService" />
		<property name="recipientDao" ref="RecipientDao" />
        <property name="blacklistModelValidator" ref="blacklistModelValidator" />
    </bean>

<!-- ============================================================================================================================== Calendar -->
	<bean id="calendarReminderService" class="com.agnitas.emm.core.reminder.service.impl.ComReminderServiceImpl">
		<property name="reminderDao" ref="CalendarCommentDao" />
		<property name="javaMailService" ref="JavaMailService" />
	</bean>

<!-- ============================================================================================================================== Companies -->
	<bean id="CompanyService" class="org.agnitas.emm.company.service.impl.CompanyServiceImpl">
		<property name="companyDao" ref="CompanyDao" />
    </bean>
    
    <bean id="CompanyTokenService" class="com.agnitas.emm.core.company.service.impl.CompanyTokenServiceImpl">
    	<property name="companyTokenDao" ref="CompanyTokenDao" />
    	<property name="companyService" ref="CompanyService" />
    	<property name="configService" ref="ConfigService" />
    	<property name="tokenGenerator" ref="DefaultTokenGenerator" />
    </bean>
    
    <bean id="CompanyAccessCheck" class="org.agnitas.emm.core.velocity.emmapi.CompanyAccessCheckImpl" >
    	<property name="configService" ref="ConfigService" />
    	<property name="javaMailService" ref="JavaMailService" />
    	<property name="companyHierarchyCache" ref="CompanyHierarchyCache" />
    </bean>

<!-- ============================================================================================================================== Component -->
	<bean id="componentService" class="com.agnitas.emm.core.components.service.impl.ComComponentServiceImpl" > <!-- Maybe this can be merged with "mailingComponentService"? -->
		<property name="mailingComponentDao" ref="MailingComponentDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="formComponentDao" ref="FormComponentDao" />
		<property name="conversionService" ref="conversionService"/>
		<property name="modelValidator" ref="componentModelValidator"/>
		<property name="mailingComponentFactory" ref="MailingComponentFactory"/>
    </bean>

<!-- ============================================================================================================================== Configuration -->
	<bean id="ConfigService" class="org.agnitas.emm.core.commons.util.ConfigService" init-method="getInstance">
		<property name="permissionService" ref="PermissionService" />
		<property name="licenseDao" ref="LicenseDao" />
		<property name="configTableDao" ref="ConfigTableDao" />
		<property name="companyInfoDao" ref="CompanyInfoDao" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="adminDao" ref="AdminDao" />
		<property name="webserviceUserDao" ref="WebserviceUserDao" />
		<property name="supervisorDao" ref="SupervisorDao" />
		<property name="dataEncryptor" ref="DataEncryptor" />
		<property name="serverMessageDao" ref="ServerMessageDao" />
		<property name="profileFieldService" ref="ProfileFieldService" />
	</bean>

<!-- ============================================================================================================================== CSV -->
	<bean id="CSVService" class="com.agnitas.service.impl.ComCSVServiceImpl">
		<property name="adminGroupDao" ref="AdminGroupDao" />
	</bean>

	<bean id="ClientService" class="com.agnitas.emm.core.mobile.service.impl.ClientServiceImpl">
		<property name="clientDao" ref="ClientDao" />
	</bean>

<!-- ============================================================================================================================== Download -->
	<bean id="DownloadService" class="org.agnitas.emm.core.download.service.DownloadServiceImpl" />

<!-- ============================================================================================================================== SFTP -->
	<bean id="SftpService" class="com.agnitas.service.impl.ComSftpServiceImpl">
		<property name="sFtpHelperFactory" ref="SFtpHelperFactory" />
	</bean>
	
	<!-- ============================================================================================================================== CompanySettings -->
	<bean id="CompanySettingsDtoFactory" class="com.agnitas.emm.core.company.factory.impl.CompanySettingsDtoFactoryImpl">
		<property name="configService" ref="ConfigService" />
	</bean>

<!-- ============================================================================================================================== Dynamic tag -->
	<bean id="AgnTagService" class="com.agnitas.service.impl.AgnTagServiceImpl">
		<property name="dynamicTagFactory" ref="DynamicTagFactory" />
		<property name="tagDetailsFactory" ref="TagDetailsFactory" />
		<property name="agnTagResolverFactory" ref="AgnTagResolverFactory" />
		<property name="tagDao" ref="TagDao" />
		<property name="agnTagAttributeResolverRegistry" ref="AgnTagAttributeResolverRegistry" />
	</bean>

	<bean id="AgnTagResolverFactory" class="com.agnitas.service.impl.AgnTagResolverFactoryImpl">
		<property name="recipientFactory" ref="RecipientFactory" />
		<property name="extensibleUidService" ref="ExtensibleUIDService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="titleDao" ref="TitleDao" />
		<property name="tagDao" ref="TagDao" />
		<property name="configService" ref="ConfigService" />
		<property name="recipientService" ref="recipientService"/>
		<property name="companyTokenService" ref="CompanyTokenService" />
	</bean>

	<bean id="AgnDynTagGroupResolverFactory" class="com.agnitas.service.impl.AgnDynTagGroupResolverFactoryImpl">
		<property name="dynamicTagDao" ref="DynamicTagDao" />
	</bean>

<!-- ============================================================================================================================== Dynamic tag content -->
	<bean id="dynamicTagContentService" class="com.agnitas.emm.core.dyncontent.service.impl.DynamicTagContentServiceImpl"/>

<!-- ============================================================================================================================== Dynamic tag names -->
	<bean id="dynamicTagNameService" class="org.agnitas.emm.core.dynname.service.impl.DynamicTagNameServiceImpl" />

<!-- ============================================================================================================================== ECS (Heatmap) -->
	<bean id="EmbeddedClickStatService" class="com.agnitas.ecs.backend.service.impl.ComEmbeddedClickStatServiceImpl">
		<property name="embeddedClickStatDao" ref="EmbeddedClickStatDao" />
		<property name="previewFactory" ref="PreviewFactory" />
		<property name="configService" ref="ConfigService" />
	</bean>

<!-- ============================================================================================================================== EMM actions -->
	<bean id="EmmActionService" class="com.agnitas.emm.core.action.service.impl.ComEmmActionServiceImpl">
		<property name="emmActionDao" ref="EmmActionDao" />
		<property name="emmActionOperationDao" ref="EmmActionOperationDao" />
		<property name="emmActionOperationService" ref="EmmActionOperationService" />
		<property name="mailingDao" ref="MailingDao" />
        <property name="conversionService" ref="conversionService"/>
        <property name="actionImporter" ref="ActionImporter"/>
        <property name="actionExporter" ref="ActionExporter"/>
    </bean>

<!-- ============================================================================================================================== EMM action operations -->
	<bean id="EmmActionOperationService" class="com.agnitas.emm.core.action.service.impl.ComEmmActionOperationServiceImpl">
		<!-- Key value equals to discriminator value in action operation entities-->
		<property name="executors">
			<list>
				<ref bean="actionOperationExecuteScript" />
				<ref bean="actionOperationUpdateCustomer" />
				<ref bean="actionOperationGetCustomer" />
				<ref bean="actionOperationActivateDoubleOptIn" />
				<ref bean="actionOperationSubscribeCustomer" />
				<ref bean="actionOperationUnsubscribeCustomer" />
				<ref bean="actionOperationSendMailing" />
				<ref bean="actionOperationServiceMail" />
				<ref bean="actionOperationGetArchiveList" />
				<ref bean="actionOperationGetArchiveMailing" />
				<ref bean="actionOperationContentView" />
				<ref bean="actionOperationIdentifyCustomer" />
			</list>
		</property>
	</bean>

	<bean id="actionOperationExecuteScript" class="com.agnitas.emm.core.action.service.impl.ActionOperationExecuteScriptImpl">
		<property name="mailingDao" ref="MailingDao" />
		<property name="beanLookupFactory" ref="beanLookupFactory" />
		<property name="javaMailService" ref="JavaMailService" />
		<property name="companyAccessCheck" ref="CompanyAccessCheck" />
		<property name="datasourceDescriptionDao" ref="DatasourceDescriptionDao" />
		<property name="sendActionbasedMailingService" ref="SendActionbasedMailingService" />
	</bean>

	<bean id="actionOperationUpdateCustomer" class="com.agnitas.emm.core.action.service.impl.ActionOperationUpdateCustomerImpl">
		<property name="recipientDao" ref="RecipientDao" />
	</bean>

	<bean id="actionOperationGetCustomer" class="com.agnitas.emm.core.action.service.impl.ActionOperationGetCustomerImpl" >
		<property name="beanLookupFactory" ref="beanLookupFactory" />
		<property name="recipientService" ref="recipientService"/>
	</bean>

	<bean id="actionOperationActivateDoubleOptIn" class="com.agnitas.emm.core.action.service.impl.ActionOperationActivateDoubleOptInImpl">
		<property name="mailingDao" ref="MailingDao" />
		<property name="bindingEntryDao" ref="BindingEntryDao" />
	</bean>

	<bean id="actionOperationUnsubscribeCustomer" class="com.agnitas.emm.core.action.service.impl.ActionOperationUnsubscribeCustomerImpl">
		<property name="mailingDao" ref="MailingDao" />
		<property name="recipientService" ref="recipientService"/>
	</bean>

	<bean id="actionOperationSendMailing" class="com.agnitas.emm.core.action.service.impl.ActionOperationSendMailingImpl">
		<property name="mailingDao" ref="MailingDao" />
		<property name="sendActionbasedMailingService" ref="SendActionbasedMailingService" />
	</bean>

	<bean id="actionOperationServiceMail" class="com.agnitas.emm.core.action.service.impl.ActionOperationServiceMailImpl">
		<property name="javaMailService" ref="JavaMailService" />
		<property name="beanLookupFactory" ref="beanLookupFactory" />
		<property name="blacklistService" ref="BlacklistService" />
		<property name="recipientService" ref="recipientService"/>
		<property name="configService" ref="ConfigService" />
	</bean>

	<bean id="actionOperationGetArchiveList" class="com.agnitas.emm.core.action.service.impl.ActionOperationGetArchiveListImpl">
		<property name="uidService" ref="ExtensibleUIDService" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="configService" ref="ConfigService" />
		<property name="mailingPreviewService" ref="MailingPreviewService" />
	</bean>

	<bean id="actionOperationGetArchiveMailing" class="com.agnitas.emm.core.action.service.impl.ActionOperationGetArchiveMailingImpl">
		<property name="previewFactory" ref="PreviewFactory" />
		<property name="mailingDao" ref="MailingDao" />
	</bean>

	<bean id="actionOperationContentView" class="com.agnitas.emm.core.action.service.impl.ActionOperationContentViewImpl">
		<property name="mailingDao" ref="MailingDao" />
		<property name="mailingPreviewService" ref="MailingPreviewService" />
	</bean>

	<bean id="actionOperationIdentifyCustomer" class="com.agnitas.emm.core.action.service.impl.ActionOperationIdentifyCustomerImpl">
		<property name="uidService" ref="ExtensibleUIDService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="beanLookupFactory" ref="beanLookupFactory" />
		<property name="configService" ref="ConfigService" />
		<property name="recipientService" ref="recipientService"/>
	</bean>

<!-- ============================================================================================================================== Host authentication -->
	<bean id="HostAuthenticationSecurityCodeGenerator" class="com.agnitas.emm.core.logon.service.DefaultHostAuthenticationSecurityCodeGenerator">
		<property name="lengthOfCode" value="8" />
		<property name="randomNumberGenerator" ref="RandomNumberGenerator" />
		<property name="alphabet" value="0123456789ABCDEF" />
	</bean>

	<bean id="ClientHostIdService" class="com.agnitas.emm.core.logon.service.impl.ClientHostIdServiceImpl">
		<property name="configService" ref="ConfigService" />
	</bean>

	<bean id="HostAuthenticationService" class="com.agnitas.emm.core.logon.service.impl.ComHostAuthenticationServiceImpl">
		<property name="configService" ref="ConfigService" />
		<property name="securityCodeGenerator" ref="HostAuthenticationSecurityCodeGenerator" />
		<property name="hostAuthenticationDao" ref="HostAuthenticationDao" />
		<property name="javaMailService" ref="JavaMailService" />
	</bean>

<!-- ============================================================================================================================== Import -->

	<bean id="ImportWizardService" class="org.agnitas.service.impl.ImportWizardServiceImpl">
		<property name="blacklistService" ref="BlacklistService" />
	</bean>


	<bean id="ProfileImportReporter" class="org.agnitas.web.ProfileImportReporter">
		<property name="recipientsReportService" ref="RecipientsReportService" />
		<property name="javaMailService" ref="JavaMailService" />
		<property name="mailinglistDao" ref="MailinglistDao" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="configService" ref="ConfigService" />
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
	</bean>

	<bean id="ImportModeHandlerFactory" class="org.agnitas.service.ImportModeHandlerFactory" />

	<bean name="RecipientExportReporter" class="org.agnitas.web.RecipientExportReporter">
		<property name="recipientsReportService" ref="RecipientsReportService"/>
		<property name="javaMailService" ref="JavaMailService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="adminService" ref="AdminService" />
		<property name="configService" ref="ConfigService" />
		<property name="targetDao" ref="TargetDao" />
		<property name="mailinglistService" ref="MailinglistService" />
	</bean>

	<bean name="RecipientReactionsExportReporter" class="org.agnitas.web.RecipientReactionsExportReporter">
		<property name="javaMailService" ref="JavaMailService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="adminService" ref="AdminService" />
		<property name="recipientsReportService" ref="RecipientsReportService" />
		<property name="configService" ref="ConfigService" />
	</bean>

	<bean name="MailingRecipientExportReporter" class="org.agnitas.web.MailingRecipientExportReporter">
		<property name="javaMailService" ref="JavaMailService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="adminService" ref="AdminService" />
		<property name="recipientsReportService" ref="RecipientsReportService" />
		<property name="configService" ref="ConfigService" />
	</bean>

	<bean name="BlacklistExportReporter" class="org.agnitas.web.BlacklistExportReporter">
		<property name="javaMailService" ref="JavaMailService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="adminService" ref="AdminService" />
		<property name="recipientsReportService" ref="RecipientsReportService" />
		<property name="configService" ref="ConfigService" />
	</bean>

<!-- ============================================================================================================================== Job queue -->
	<bean id="JobQueueService" class="org.agnitas.service.JobQueueService">
		<property name="configService" ref="ConfigService" />
		<property name="jobQueueDao" ref="JobQueueDao" />
		<property name="configTableDao" ref="ConfigTableDao" />
		<property name="birtReportDao" ref="BirtReportDao" />
		<property name="beanLookupFactory" ref="beanLookupFactory" />
		<property name="daoLookupFactory" ref="daoLookupFactory" />
		<property name="serviceLookupFactory" ref="serviceLookupFactory" />
		<property name="mailNotificationService" ref="MailNotificationService" />
	</bean>

<!-- ============================================================================================================================== Login -->
	<bean id="LogonService" class="com.agnitas.emm.core.logon.service.impl.ComLogonServiceImpl">
		<property name="configService" ref="ConfigService" />
        <property name="adminPreferencesDao" ref="AdminPreferencesDao" />
		<property name="emmLayoutBaseDao" ref="EmmLayoutBaseDao" />
		<property name="adminService" ref="AdminService" />
		<property name="supervisorService" ref="SupervisorService" />
		<property name="passwordCheck" ref="PasswordCheck" />
		<property name="passwordResetDao" ref="PasswordResetDao" />
		<property name="loginTrackService" ref="GuiLoginTrackService" />
		<property name="javaMailService" ref="JavaMailService" />
		<property name="dataSource" ref="dataSource" />
		<property name="previewFactory" ref="PreviewFactory" />
	</bean>

<!-- ============================================================================================================================== Login tracking -->
	<bean id="GuiLoginTrackService" class="org.agnitas.emm.core.logintracking.service.impl.LoginTrackServiceImpl">
		<property name="loginTrackDao" ref="GuiLoginTrackDao" />
        
        <property name="loginTrackSettingsDao">
        	<bean class="org.agnitas.emm.core.logintracking.dao.GuiLoginTrackSettingsDaoImpl">
	        	<property name="configService" ref="ConfigService" />
	        </bean>
        </property>
    </bean>

	<bean id="UserSelfService" class="com.agnitas.emm.core.user.service.impl.UserSelfServiceImpl">
		<property name="loginTrackService" ref="GuiLoginTrackService" />
	</bean>
 
	<bean id="LoginTrackServiceRequestHelper" class="org.agnitas.emm.core.logintracking.LoginTrackServiceRequestHelper">
		<property name="loginTrackService" ref="GuiLoginTrackService" />
	</bean>

<!-- ============================================================================================================================== Mailing -->
	<bean id="SendActionbasedMailingService" class="com.agnitas.emm.core.mailing.service.impl.SendActionbasedMailingServiceImpl">
		<property name="mailgunFactory" ref="MailgunFactory" />
		<property name="maildropStatusDao" ref="MaildropStatusDao" />
	</bean>

	<bean id="MailingLightService" class="com.agnitas.service.impl.ComMailingLightServiceImpl">
		<property name="mailingDao" ref="MailingDao" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="maildropService" ref="MaildropService" />
	</bean>

	<bean id="MailingService" class="com.agnitas.emm.core.mailing.service.impl.MailingServiceImpl">
		<property name="mailingComponentDao" ref="MailingComponentDao" />
		<property name="configService" ref="ConfigService" />
		<property name="javaMailService" ref="JavaMailService" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="mailingBaseService" ref="MailingBaseService"/>
		<property name="mailingContentService" ref="MailingContentService"/>
		<property name="adminService" ref="AdminService"/>
	</bean>

<!-- ============================================================================================================================== Maildrop status -->
	<bean id="MaildropStatusService" class="com.agnitas.emm.core.mailing.service.impl.MaildropStatusServiceImpl">
		<property name="maildropStatusDao" ref="MaildropStatusDao" />
	</bean>

<!-- ============================================================================================================================== Mailing delivery lock service -->
	<bean id="MailingDeliveryLockService" class="com.agnitas.emm.core.mailing.service.impl.MailingDeliveryLockServiceImpl">
		<property name="mailingDeliveryLockDao" ref="MailingDeliveryLockDao" />
		<property name="maildropStatusService" ref="MaildropStatusService"/>
	</bean>

<!-- ============================================================================================================================== Mailing component -->
	<bean id="mailingComponentService" class="com.agnitas.emm.core.components.service.impl.ComMailingComponentsServiceImpl">
		<property name="mimeTypeService" ref="MimeTypeService" />
		<property name="sftpService" ref="SftpService" />
		<property name="mailingDao" ref="MailingDao" />
        <property name="mailingComponentDao" ref="MailingComponentDao" />
		<property name="mailingComponentFactory" ref="MailingComponentFactory" />
		<property name="configService" ref="ConfigService" />
		<property name="uploadDao" ref="UploadDao" />
		<property name="componentValidationService" ref="ComponentValidationService" />
        <property name="conversionService" ref="conversionService"/>
    </bean>

<!-- ============================================================================================================================== Mailing Stop -->
	<bean id="MailingStopService" class="com.agnitas.emm.core.mailing.service.impl.MailingStopServiceImpl">
		<property name="serverPrioService" ref="ServerPrioService" />
		<property name="mailingService" ref="MailingService" />
		<property name="maildropService" ref="MaildropService" />
		<property name="copyMailingService" ref="CopyMailingService" />
		<property name="companyInfoDao" ref="CompanyInfoDao" />
		<property name="eqlFacade" ref="EqlFacade" />
		<property name="companyService" ref="CompanyService" />
	</bean>

<!-- ============================================================================================================================== Mailing parameter -->
	<bean id="MailingParameterService" class="com.agnitas.emm.core.mailing.service.impl.ComMailingParameterServiceImpl">
		<property name="mailingParameterDao" ref="MailingParameterDao" />
		<property name="mailingParameterLogService" ref="mailingParameterLogService"/>
	</bean>

<!-- ============================================================================================================================== Maildrop -->
	<bean id="MaildropService" class="com.agnitas.emm.core.maildrop.service.MaildropServiceImpl">
		<property name="maildropStatusDao" ref="MaildropStatusDao" />
		<property name="mailingDao" ref="MailingDao" />

	</bean>

<!-- ============================================================================================================================== Mailinglists -->
	<bean id="MailinglistService" class="com.agnitas.emm.core.mailinglist.service.impl.ComMailinglistServiceImpl">
		<property name="mailinglistDao" ref="MailinglistDao" />
		<property name="mailinglistApprovalDao" ref="MailinglistApprovalDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="bindingEntryDao" ref="BindingEntryDao" />
		<property name="birtReportDao" ref="BirtReportDao" />
        <property name="conversionService" ref="conversionService"/>
        <property name="recipientDao" ref="RecipientDao"/>
        <property name="targetDao" ref="TargetDao"/>
    </bean>
    
	<bean id="MailinglistApprovalService" class="com.agnitas.emm.core.mailinglist.service.impl.MailinglistApprovalServiceImpl">
		<property name="mailinglistApprovalDao" ref="MailinglistApprovalDao" />
		<property name="adminService" ref="AdminService" />
		<property name="mailinglistDao" ref="MailinglistDao" />
	</bean>

	<bean id="WS_mailinglistService" class="org.agnitas.emm.core.mailinglist.service.impl.MailinglistServiceImpl" />

<!-- ============================================================================================================================== Mailing preview -->
	<bean id="MailingPreviewService" class="com.agnitas.mailing.preview.service.MailingPreviewServiceImpl">
		<property name="previewFactory" ref="PreviewFactory" />
	</bean>

<!-- ============================================================================================================================== Mailloop -->
	<bean id="MailloopService" class="com.agnitas.emm.core.mailloop.service.impl.MailloopServiceImpl">
		<property name="mailloopDao" ref="MailloopDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="sendActionbasedMailingService" ref="SendActionbasedMailingService" />
	</bean>
	

<!-- ============================================================================================================================== PDF -->
	<bean id="PDFService" class="com.agnitas.service.impl.ComPDFServiceImpl">
		<property name="adminGroupDao" ref="AdminGroupDao" />
	</bean>

	<bean id="GenerationPDFService" class="com.agnitas.emm.core.workflow.service.GenerationPDFService" />

<!-- ============================================================================================================================== Profile fields -->
	<bean id="ColumnInfoService" class="com.agnitas.service.impl.ComColumnInfoServiceImpl">
		<property name="profileFieldDao" ref="ProfileFieldDao" />
	</bean>

	<bean id="mailingSizeCalculationService" class="com.agnitas.emm.core.mailing.service.impl.MailingSizeCalculationServiceImpl">
		<constructor-arg ref="mailingComponentService"/>
		<constructor-arg ref="AgnTagService"/>
		<constructor-arg ref="LinkService"/>
	</bean>

<!-- ============================================================================================================================== Recipient -->
	<bean id="recipientService" class="org.agnitas.emm.core.recipient.service.impl.RecipientServiceImpl">
		<property name="recipientDao" ref="RecipientDao" />
		<property name="uidService" ref="ExtensibleUIDService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="recipientFactory" ref="RecipientFactory" />
		<property name="configService" ref="ConfigService" />
		<property name="sendActionbasedMailingService" ref="SendActionbasedMailingService" />
		<property name="targetService" ref="targetService"/>
		<property name="profileFieldDao" ref="ProfileFieldDao"/>
        <property name="profileFieldValidationService" ref="profileValidationService"/>
        <property name="columnInfoService" ref="ColumnInfoService" />
        <property name="targetEqlQueryBuilder" ref="TargetEqlQueryBuilder"/>
		<property name="recipientQueryBuilder" ref="RecipientQueryBuilder"/>
		<property name="recipientWorkerFactory" ref="RecipientWorkerFactory"/>
		<property name="adminService" ref="AdminService"/>
		<property name="bindingEntryDao" ref="BindingEntryDao"/>
		<property name="bindingEntryFactory" ref="BindingEntryFactory"/>
		<property name="conversionService" ref="conversionService"/>
		<property name="mailinglistDao" ref="MailinglistDao"/>
		<property name="targetDao" ref="TargetDao" />
		<property name="eqlFacade" ref="EqlFacade" />
	</bean>

	<bean id="recipientBulkService" class="org.agnitas.emm.core.recipient.service.impl.RecipientBulkServiceImpl">
		<property name="recipientDao" ref="RecipientDao" />
		<property name="recipientService" ref="recipientService" />
		<property name="validator" ref="modelValidator" />
		<property name="recipientFactory" ref="RecipientFactory" />
	</bean>

<!-- ============================================================================================================================== Report -->
	<bean id="BirtReportService" class="com.agnitas.emm.core.birtreport.service.impl.ComBirtReportServiceImpl">
		<property name="birtReportDao" ref="BirtReportDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="dataSource" ref="dataSource" />
	</bean>

<!-- ============================================================================================================================== Server Prio -->
	<bean id="ServerPrioService" class="com.agnitas.emm.core.serverprio.server.impl.ServerPrioServiceImpl">
		<property name="serverPrioDao" ref="ServerPrioDao" />
	</bean>

<!-- ============================================================================================================================== Service mails -->
	<bean id="SendServiceMailService" class="com.agnitas.emm.core.servicemail.impl.SendServiceMailServiceImpl">
		<property name="emmActionService" ref="EmmActionService" />
	</bean>

<!-- ============================================================================================================================== Statistic -->
	<bean id="BirtStatisticsService" class="com.agnitas.emm.core.birtstatistics.service.impl.BirtStatisticsServiceImpl" >
		<property name="configService" ref="ConfigService" />
        <property name="adminService" ref="AdminService" />
    </bean>

<!-- ============================================================================================================================== Statistics job -->
	<bean id="MailingSummaryStatisticJobService" class="com.agnitas.emm.core.stat.service.impl.MailingSummaryStatisticJobServiceImpl" >
		<property name="mailingDao" ref="MailingDao" />
		<property name="lightTargetDao" ref="LightTargetDao" />
		<property name="mailingStatJobDao" ref="MailingStatJobDao" />
		<property name="mailingStatTgtGrpDao" ref="MailingStatTgtGrpDao" />
		<property name="configService" ref="ConfigService" />
		<property name="workerExecutorService" ref="WorkerExecutorService" />
	</bean>

<!-- ============================================================================================================================== Supervisor -->
	<bean id="SupervisorService" class="com.agnitas.emm.core.supervisor.service.impl.ComSupervisorServiceImpl">
		<property name="configService" ref="ConfigService" />
		<property name="supervisorDao" ref="SupervisorDao" />
		<property name="passwordCheck" ref="PasswordCheck" />
	</bean>

	<bean id="SupervisorLoginPermissionService" class="com.agnitas.emm.core.supervisor.service.impl.SupervisorLoginPermissionServiceImpl">
		<property name="grantSupervisorLoginDao" ref="GrantedSupervisorLoginDao" />
		<property name="departmentService" ref="DepartmentService" />
	</bean>

<!-- ============================================================================================================================== Tags -->
	<bean id="TagSyntaxChecker" class="org.agnitas.preview.TagSyntaxChecker">
		<property name="tagDao" ref="TagDao" />
	</bean>

<!-- ============================================================================================================================== Target groups -->
	<bean id="MailingTargetGroupLocator" class="org.agnitas.emm.core.target.service.impl.MailingTargetGroupLocator">
		<property name="mailingDao" ref="MailingDao" />
	</bean>

	<bean id="MaildropTargetGroupLocator" class="org.agnitas.emm.core.target.service.impl.MaildropTargetGroupLocator">
		<property name="maildropTargetGroupLocatorDao" ref="MaildropTargetGroupLocatorDao" />
	</bean>

	<bean id="ExportPredefTargetGroupLocator" class="org.agnitas.emm.core.target.service.impl.ExportPredefTargetGroupLocator">
		<property name="exportPredefTargetGroupLocatorDao" ref="ExportPredefTargetGroupLocatorDao" />
	</bean>

	<bean id="MailingComponentTargetGroupLocator" class="org.agnitas.emm.core.target.service.impl.MailingComponentTargetGroupLocator">
		<property name="mailingDao" ref="MailingDao" />
	</bean>

	<bean id="MailingContentTargetGroupLocator" class="org.agnitas.emm.core.target.service.impl.MailingContentTargetGroupLocator">
		<property name="mailingDao" ref="MailingDao" />
	</bean>

	<bean id="targetService" class="com.agnitas.emm.core.target.service.impl.ComTargetServiceImpl">
		<property name="targetDao" ref="TargetDao" />
		<property name="mailingComponentDao" ref="MailingComponentDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="targetGroupLocator" ref="TargetGroupLocator" />
		<property name="recipientDao" ref="RecipientDao" />
		<property name="eqlFacade" ref="EqlFacade" />
		<property name="profileFieldService" ref="ProfileFieldService" />
		<property name="beanShellInterpreterFactory" ref="BeanShellInterpreterFactory" />
		<property name="targetComplexityEvaluator" ref="TargetComplexityEvaluator"/>
		<property name="columnInfoService" ref="ColumnInfoService" />
		<property name="referencedItemsService" ref="TargetGroupsReferencedItemsService" />
		<property name="adminService" ref="AdminService"/>
		<property name="targetFactory" ref="TargetFactory"/>
		<property name="queryBuilderToEqlConverter" ref="QueryBuilderToEqlConverter"/>
		<property name="eqlValidatorService" ref="eqlValidatorService"/>
	</bean>

	<bean id="eqlValidatorService" class="com.agnitas.emm.core.target.eql.EqlValidatorServiceImpl">
		<property name="eqlFacade" ref="EqlFacade"/>
	</bean>
	
	<bean id="TargetGroupsReferencedItemsService" class="com.agnitas.emm.core.target.service.impl.ReferencedItemsServiceImpl">
		<property name="referencedItemsDao" ref="TargetGroupsReferencedItemsDao" />
	</bean>

	<bean name="TargetComplexityEvaluator" class="com.agnitas.emm.core.target.complexity.service.impl.TargetComplexityEvaluatorImpl">
		<property name="eqlParser" ref="EqlParser"/>
		<property name="targetComplexityAnalyzerMap" ref="TargetComplexityAnalyzerMap"/>
	</bean>

	<bean id="TargetCopyService" class="com.agnitas.emm.core.target.service.impl.ComTargetCopyServiceImpl" />
<!-- ============================================================================================================================== Token generators -->
	<bean id="DefaultTokenGenerator" class="com.agnitas.emm.core.commons.tokengen.RandomTokenGenerator">
		<constructor-arg>
			<bean class="java.security.SecureRandom" />
		</constructor-arg>
	</bean>

<!-- ============================================================================================================================== Trackable links -->
	<bean id="TrackeableLinkService" class="com.agnitas.emm.core.trackablelinks.service.impl.ComTrackableLinkServiceImpl">
		<property name="trackableLinkDao" ref="TrackableLinkDao" />
		<property name="mailingService" ref="MailingService" />
	</bean>

	<bean id="FormTrackableLinkService" class="com.agnitas.emm.core.trackablelinks.service.impl.FormTrackableLinkServiceImpl">
		<property name="trackableLinkDao" ref="FormTrackableLinkDao"/>
		<property name="linkService" ref="LinkService"/>
        <property name="conversionService" ref="conversionService"/>
    </bean>

<!-- ============================================================================================================================== UID -->
	<bean id="ExtensibleUIDService" class="com.agnitas.emm.core.commons.uid.impl.ComExtensibleUIDServiceImpl">
		<property name="parser" ref="ExtensibleUIDParser" />
		<property name="stringBuilder" ref="ExtensibleUIDStringBuilder" />
	</bean>

<!-- ============================================================================================================================== User activity log -->
	<bean id="UserActivityLogService" class="org.agnitas.emm.core.useractivitylog.service.DbUserActivityLogServiceImpl">
		<property name="userActivityLogDao" ref="UserActivityLogDao" />
	</bean>

<!-- ============================================================================================================================== User form -->
	<bean id="userformService" class="com.agnitas.emm.core.userform.service.impl.ComUserformServiceImpl">
		<property name="userFormDao" ref="UserFormDao" />
        <property name="emmActionDao" ref="EmmActionDao"/>
		<property name="conversionService" ref="conversionService"/>
		<property name="trackableLinkService" ref="FormTrackableLinkService"/>
        <property name="userFormExporter" ref="UserFormExporter"/>
		<property name="configService" ref="ConfigService"/>
		<property name="uidService" ref="ExtensibleUIDService"/>
		<property name="comRecipientDao" ref="RecipientDao"/>
		<property name="profileFieldService" ref="ProfileFieldService"/>
		<property name="companyTokenService" ref="CompanyTokenService" />
		<property name="recipientService" ref="recipientService" />
	</bean>

<!-- ============================================================================================================================== Velocity -->
	<bean id="ScriptHelperService" class="com.agnitas.emm.core.scripthelper.service.ScriptHelperService">
		<property name="mailingDao" ref="MailingDao" />
		<property name="previewFactory" ref="PreviewFactory" />
	</bean>

<!-- ============================================================================================================================== Workflow -->
	<bean id="workflowStartStopReminderService" class="com.agnitas.emm.core.reminder.service.impl.ComReminderServiceImpl">
		<property name="reminderDao" ref="comWorkflowStartStopReminderDao" />
		<property name="javaMailService" ref="JavaMailService" />
	</bean>

	<bean id="WorkflowStatisticsService" class="com.agnitas.emm.core.workflow.service.ComWorkflowStatisticsService">
		<property name="workflowDao" ref="comWorkflowDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="recipientDao" ref="RecipientDao" />
		<property name="workflowService" ref="WorkflowService" />
		<property name="activationService" ref="WorkflowActivationService" />
		<property name="targetService" ref="targetService" />
		<property name="optimizationService" ref="optimizationService" />
	</bean>

	<bean id="WorkflowDataParser" class="com.agnitas.emm.core.workflow.service.ComWorkflowDataParser" />

	<bean id="WorkflowService" class="com.agnitas.emm.core.workflow.service.impl.ComWorkflowServiceImpl">
		<property name="workflowDao" ref="comWorkflowDao" />
		<property name="mailingDao" ref="MailingDao" />
		<property name="targetDao" ref="TargetDao" />
		<property name="targetService" ref="targetService" />
		<property name="linkDao" ref="TrackableLinkDao" />
		<property name="columnInfoService" ref="ColumnInfoService" />
		<property name="adminService" ref="AdminService" />
		<property name="userFormDao" ref="UserFormDao" />
		<property name="birtCompanyDao" ref="BirtCompanyDao" />
		<property name="reactionDao" ref="WorkflowReactionDao" />
		<property name="mailingSendService" ref="MailingSendService" />
		<property name="workflowValidationService" ref="WorkflowValidationService" />
		<property name="optimizationService" ref="optimizationService" />
		<property name="optimizationCommonService" ref="optimizationCommonService" />
		<property name="birtReportDao" ref="BirtReportDao" />
		<property name="sendActionbasedMailingService" ref="SendActionbasedMailingService" />
		<property name="profileFieldDao" ref="ProfileFieldDao" />
		<property name="workflowDataParser" ref="WorkflowDataParser" />
		<property name="workflowStartStopReminderDao" ref="comWorkflowStartStopReminderDao" />
		<property name="reminderService" ref="workflowStartStopReminderService" />
		<property name="reminderDao" ref="comWorkflowStartStopReminderDao" />
		<property name="campaignDao" ref="CampaignDao"/>
		
		<!-- Self injection -->
		<property name="selfReference" ref="WorkflowService" />
	</bean>

<!-- ============================================================================================================================== ??? -->

	<bean id="multipartResolver"
		  class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
	</bean>

<!-- ============================================================================================================================== Device -->
	<bean id="DeviceService" class="com.agnitas.emm.core.mobile.service.impl.ComDeviceServiceImplBasic"/>

<!-- ============================================================================================================================== User Form Execution -->
	<bean id="UserFormExecutionService" class="com.agnitas.emm.core.userform.service.impl.UserFormExecutionServiceImpl">
		<property name="configService" ref="ConfigService" />
		<property name="extensibleUIDService" ref="ExtensibleUIDService" />
		<property name="deviceService" ref="DeviceService" />
		<property name="recipientDao" ref="RecipientDao" />
		<property name="userFormDao" ref="UserFormDao" />
		<property name="clientService" ref="ClientService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="mailingContentTypeCache" ref="MailingContentTypeCache" />
        <property name="trackableLinkDao" ref="FormTrackableLinkDao"/>
		<property name="recipientFactory" ref="RecipientFactory" />
		<property name="recipientService" ref="recipientService"/>
    </bean>
	
<!-- ============================================================================================================================== Hash tags -->
	<bean id="HashTagRegistry" class="com.agnitas.emm.core.hashtag.service.HashTagRegistryImpl">
		<property name="hashTags">
			<list>
				<ref bean="UnencodedProfileFieldHashTag" />
				<ref bean="ProfileFieldEncryptionHashTag" />
				<ref bean="HexProfileFieldEncodingHashTag" />
				<ref bean="Rot47ProfileFieldHashTag" />
				<ref bean="Md5ProfileFieldHashTag" />
				<ref bean="DateHashTag" />
				<ref bean="AlterHashTag" />
				<ref bean="Base64urlProfileFieldEncodingHashTag" />
			</list>
		</property>
	</bean>
	
	<bean id="HashTagEvaluationService" class="com.agnitas.emm.core.hashtag.service.HashTagEvaluationServiceImpl">
		<property name="hashTagRegistry" ref="HashTagRegistry" />
		<property name="fallbackHashTag" ref="ProfileFieldHashTag" />
	</bean>

<!-- ============================================================================================================================== Misc. -->
	<bean id="imageHelperService" class="org.agnitas.emm.core.imagehelper.ImageHelperService">
		<property name="configService" ref="ConfigService" />
	</bean>

	<bean id="linkcheckService" class="org.agnitas.service.LinkcheckService" >
		<property name="configService" ref="ConfigService" />
	</bean>

	<bean id="MimeTypeService" class="com.agnitas.service.MimeTypeService" />

	<bean id="MailNotificationService" class="com.agnitas.service.MailNotificationService" >
		<property name="mailNotificationBufferDao" ref="MailNotificationBufferDao" />
		<property name="javaMailService" ref="JavaMailService" />
	</bean>

	<bean id="dataSourceService" class="com.agnitas.service.impl.DataSourceServiceImpl" >
		<property name="datasourceDescriptionDao" ref="DatasourceDescriptionDao" />
        <property name="webserviceUserDao" ref="WebserviceUserDao"/>
    </bean>

	<bean id="DataEncryptor" class="org.agnitas.util.DataEncryptor">
		<property name="configService" ref="ConfigService" />
	</bean>

	<bean id="RecipientProfileHistoryService" class="com.agnitas.emm.core.recipient.service.impl.RecipientProfileHistoryBasicServiceImpl">
		<property name="recipientProfileHistoryDao" ref="RecipientProfileHistoryDao" />
		<property name="configService" ref="ConfigService" />
		<property name="profileFieldDao" ref="ProfileFieldDao" />
	</bean>

	<bean id="JavaMailService" class="com.agnitas.emm.core.JavaMailServiceImpl">
		<property name="configService" ref="ConfigService" />
		<property name="dkimDao" ref="DkimDao" />
	</bean>

	<bean id="LinkService" class="com.agnitas.emm.core.linkcheck.service.LinkServiceImpl">
		<property name="mailingDao" ref="MailingDao" />
		<property name="mailingParameterDao" ref="MailingParameterDao" />
		<property name="configService" ref="ConfigService" />
		<property name="extensibleUIDService" ref="ExtensibleUIDService" />
		<property name="agnTagService" ref="AgnTagService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="hashTagEvaluationService" ref="HashTagEvaluationService" />
    </bean>

	<bean id="CopyMailingService" class="org.agnitas.emm.core.mailing.service.impl.CopyMailingServiceImpl">
		<property name="mailingExporter" ref="MailingExporter" />
		<property name="mailingImporter" ref="MailingImporter" />
	</bean>

	<bean id="ImportProfileService" class="org.agnitas.service.impl.ImportProfileServiceImpl">
		<property name="importProfileDao" ref="ImportProfileDao" />
	</bean>
	
	<bean id="UserFormExporter" class="org.agnitas.service.impl.UserFormExporterImpl" />
	
	<bean id="UserFormImporter" class="org.agnitas.service.impl.UserFormImporterImpl" />
	
	<bean id="ActionExporter" class="org.agnitas.service.impl.ActionExporter" />
	
	<bean id="ActionImporter" class="org.agnitas.service.impl.ActionImporter" />
	
	<bean id="ProfileFieldService" class="com.agnitas.emm.core.profilefields.service.impl.ProfileFieldServiceImpl">
		<property name="profileFieldDao" ref="ProfileFieldDao" />
		<property name="columnInfoService" ref="ColumnInfoService"/>
		<property name="workflowService" ref="WorkflowService"/>
		<property name="targetService" ref="targetService"/>
 	</bean>

	<bean id="profileValidationService" class="com.agnitas.emm.core.profilefields.service.impl.ProfileFieldValidationServiceImpl">
		<property name="profileFieldDao" ref="ProfileFieldDao" />
        <property name="targetService" ref="targetService"/>
        <property name="databaseKeywordList" ref="databaseKeywordList"/>
		<property name="configService" ref="ConfigService" />
 	</bean>

	<bean id="PatternScheduleConfig" class="org.agnitas.emm.core.schedule.PatternScheduleConfig">
		<constructor-arg name="weekDays">
			<util:map>
				<!--Empty value to schedule daily run-->
				<entry key="0" value="" />
				<entry key="1" value="Su" />
				<entry key="2" value="Mo" />
				<entry key="3" value="Tu" />
				<entry key="4" value="We" />
				<entry key="5" value="Th" />
				<entry key="6" value="Fr" />
				<entry key="7" value="Sa" />
			</util:map>
		</constructor-arg>
		<constructor-arg name="monthlyPatterns">
			<util:map>
				<entry key="1" value="M01" />
				<entry key="15" value="M15" />
				<entry key="99" value="M99" />
			</util:map>
		</constructor-arg>
		<constructor-arg name="fromFormat" value="HH:mm" />
		<constructor-arg name="toFormat" value="HHmm" />
	</bean>

	<bean id="PatternScheduleBuilderService" class="org.agnitas.emm.core.schedule.PatternScheduleBuilderService">
		<constructor-arg name="config" ref="PatternScheduleConfig"/>
	</bean>

	<bean id="IntervalPatternScheduleBuilderService" class="org.agnitas.emm.core.schedule.IntervalPatternScheduleBuilderService">
		<constructor-arg name="config" ref="PatternScheduleConfig"/>
		<constructor-arg name="patternScheduleBuilderService" ref="PatternScheduleBuilderService"/>
	</bean>

	<bean id="MailClickTrackingService" class="com.agnitas.emm.core.mailtracking.service.ClickTrackingServiceImpl">
		<property name="trackableLinkDao" ref="TrackableLinkDao" />
		<property name="configService" ref="ConfigService" />
		<property name="mailingContentTypeCache" ref="MailingContentTypeCache" />
		<property name="recipientFactory" ref="RecipientFactory" />
		<property name="recipientService" ref="recipientService"/>
	</bean>
	
	<bean id="MailOpenTrackingService" class="com.agnitas.emm.core.mailtracking.service.OpenTrackingServiceImpl">
		<property name="onepixelDao" ref="OnepixelDao" />	
		<property name="recipientFactory" ref="RecipientFactory" />
		<property name="configService" ref="ConfigService" />
		<property name="mailingContentTypeCache" ref="MailingContentTypeCache" />
		<property name="recipientService" ref="recipientService"/>
	</bean>

	<bean id="FullviewService" class="com.agnitas.emm.core.mailing.service.impl.FullviewServiceImpl">
		<property name="companyService" ref="CompanyService" />
		<property name="userFormService" ref="userformService" />
		<property name="mailingService" ref="MailingService" />
		<property name="configService" ref="ConfigService" />
		<property name="recipientService" ref="recipientService" />
		<property name="extensibleUidService" ref="ExtensibleUIDService" />
		<property name="companyTokenService" ref="CompanyTokenService" />
	</bean>

	<bean id="ImportModeAddHandler" class="org.agnitas.util.importvalues.ImportModeAddHandler">
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
		<property name="configService" ref="ConfigService" />
	</bean>
	
	<bean id="ImportModeAddAndUpdateHandler" class="org.agnitas.util.importvalues.ImportModeAddAndUpdateHandler">
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
		<property name="configService" ref="ConfigService" />
	</bean>
	
	<bean id="ImportModeUpdateHandler" class="org.agnitas.util.importvalues.ImportModeUpdateHandler">
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
	</bean>
	
	<bean id="ImportModeAddAndUpdateForcedHandler" class="org.agnitas.util.importvalues.ImportModeAddAndUpdateForcedHandler">
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
		<property name="configService" ref="ConfigService" />
	</bean>
	
	<bean id="ImportModeUnsubscribeHandler" class="org.agnitas.util.importvalues.ImportModeUnsubscribeHandler">
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
	</bean>
	
	<bean id="ImportModeReactivateSuspendedHandler" class="org.agnitas.util.importvalues.ImportModeReactivateSuspendedHandler">
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
	</bean>
	
	<bean id="ImportModeMarkAsBounceHandler" class="org.agnitas.util.importvalues.ImportModeMarkAsBounceHandler">
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
	</bean>
	
	<bean id="ImportModeBounceReactivateHandler" class="org.agnitas.util.importvalues.ImportModeBounceReactivateHandler">
		<property name="importRecipientsDao" ref="ImportRecipientsDao" />
	</bean>
	
	<bean id="ImportModeBlacklistHandler" class="org.agnitas.util.importvalues.ImportModeBlacklistHandler" />
	
	<bean id="ImportModeBlacklistExclusiveHandler" class="org.agnitas.util.importvalues.ImportModeBlacklistExclusiveHandler" />

	<bean id="DepartmentService" class="com.agnitas.emm.core.departments.service.DepartmentServiceImpl">
		<property name="departmentDao" ref="DepartmentDao" />
	</bean>
	
	<bean id="MimeTypeWhitelistService" class="com.agnitas.emm.core.mimetypes.service.MimeTypeWhitelistServiceImpl">
		<property name="mimeTypeWhitelistPatternDao" ref="MimeTypeWhitelistPatternDao" />
	</bean>
	
	<bean id="SessionHijackingPreventionService" class="com.agnitas.emm.core.sessionhijacking.service.SessionHijackingPreventionServiceImpl">
		<property name="sessionHijackingPreventionDao" ref="SessionHijackingPreventionDataDao" />
	</bean>

	<bean id="dashboardService" class="com.agnitas.emm.core.dashboard.service.impl.DashboardServiceImpl">
		<property name="mailingDao" ref="MailingDao"/>
		<property name="summaryDataSetFactory" ref="summaryDataSetFactory"/>
	</bean>

	<bean id="calendarService" class="com.agnitas.emm.core.calendar.service.impl.CalendarServiceImpl">
		<property name="mailingDao" ref="MailingDao"/>
    </bean>

	<bean id="calendarCommentService" class="com.agnitas.emm.core.calendar.service.impl.CalendarCommentServiceImpl">
		<property name="adminService" ref="AdminService"/>
		<property name="calendarCommentDao" ref="CalendarCommentDao"/>
		<property name="reminderService" ref="calendarReminderService" />
	</bean>

	<bean id="deliveryService" class="com.agnitas.emm.core.delivery.service.impl.DeliveryServiceImpl">
		<property name="deliveryDao" ref="deliveryDao"/>
		<property name="mailingBaseService" ref="MailingBaseService" />
	</bean>
	
		
	<!-- ============================================================================================================================== Mobile phone whitelist -->
	<bean id="MobilephoneNumberWhitelist" class="com.agnitas.emm.mobilephone.service.MobilephoneNumberWhitelistImpl">
		<property name="mobilephoneNumberWhitelistDao" ref="MobilephoneNumberWhitelistDao" />
	</bean>

<!-- ============================================================================================================================== Upload -->
	<bean id="uploadService" class="com.agnitas.emm.core.upload.service.impl.UploadServiceImpl">
		<property name="uploadDao" ref="UploadDao" />
		<property name="adminService" ref="AdminService" />
		<property name="companyDao" ref="CompanyDao" />
		<property name="javaMailService" ref="JavaMailService" />
        <property name="conversionService" ref="conversionService"/>
        <property name="configService" ref="ConfigService"/>
    </bean>
    
    <bean id="PermissionService" class="com.agnitas.emm.core.permission.service.PermissionServiceImpl">
    	<property name="permissionDao" ref="PermissionDao" />
    </bean>
    
    <bean id="WebservicePermissionService" class="com.agnitas.emm.wsmanager.service.impl.WebservicePermissionServiceImpl">
    	<property name="webservicePermissionDao" ref="WebservicePermissionDao" />
    </bean>
    
    <bean id="WebservicePermissionGroupService" class="com.agnitas.emm.wsmanager.service.impl.WebservicePermissionGroupServiceImpl">
    	<property name="webservicePermissionGroupDao" ref="WebservicePermissionGroupDao" />
    </bean>

	<!-- ============================================================================================================================== Start-Up jobs -->
	<bean id="StartupJobExecutionService" class="com.agnitas.startuplistener.service.StartupJobExecutionServiceImpl">
		<property name="startupJobEntryDao" ref="StartupJobEntryDao" />
		<property name="configService" ref="ConfigService" />
		<property name="dataSource" ref="dataSource" />
	</bean>
	
	<!--  -->
	
	<bean id="LandingpageService" class="com.agnitas.emm.landingpage.service.LandingpageServiceImpl">
		<property name="landingpageDao" ref="LandingpageDao" />
		<property name="configService" ref="ConfigService" />
	</bean>
	
	<bean id="ImageCache" class="com.agnitas.web.ImageCache">
		<property name="configService" ref="ConfigService" />
	</bean>
	
	<bean id="CdnCache" class="com.agnitas.web.CdnCache">
		<property name="configService" ref="ConfigService" />
	</bean>
	
	<bean id="SubscriberLimitCheck" class="org.agnitas.emm.core.recipient.service.impl.SubscriberLimitCheckImpl">
		<constructor-arg ref="ConfigService" />
		<constructor-arg ref="RecipientDao" />
	</bean>
	
	<bean id="RestfulServiceHandler_recipient" class="com.agnitas.emm.restful.recipient.RecipientRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="recipientDao" ref="RecipientDao" />
		<property name="bindingEntryDao" ref="BindingEntryDao" />
		<property name="columnInfoService" ref="ColumnInfoService" />
		<property name="mailinglistDao" ref="MailinglistDao" />
		<property name="profileImportWorkerFactory" ref="ProfileImportWorkerFactory" />
		<property name="datasourceDescriptionDao" ref="DatasourceDescriptionDao" />
		<property name="fullviewService" ref="FullviewService"/>
		<property name="configService" ref="ConfigService" />
		<property name="subscriberLimitCheck" ref="SubscriberLimitCheck" />
	</bean>
	
	<bean id="RestfulServiceHandler_mailinglist" class="com.agnitas.emm.restful.mailinglist.MailinglistRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="mailinglistDao" ref="MailinglistDao" />
		<property name="recipientDao" ref="RecipientDao" />
		<property name="columnInfoService" ref="ColumnInfoService" />
	</bean>
	
	<bean id="RestfulServiceHandler_blacklist" class="com.agnitas.emm.restful.blacklist.BlacklistRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="blacklistDao" ref="BlacklistDao" />
	</bean>
	
	<bean id="RestfulServiceHandler_mailing" class="com.agnitas.emm.restful.mailing.MailingRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="mailingDao" ref="MailingDao" />
		<property name="mailinglistDao" ref="MailinglistDao" />
		<property name="mailingExporter" ref="MailingExporter" />
		<property name="mailingImporter" ref="MailingImporter" />
		<property name="copyMailingService" ref="CopyMailingService" />
		<property name="thumbnailService" ref="ThumbnailService" />
	</bean>
	
	<bean id="RestfulServiceHandler_component" class="com.agnitas.emm.restful.component.ComponentRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="mailingDao" ref="MailingDao" />
		<property name="mailingComponentDao" ref="MailingComponentDao" />
		<property name="targetDao" ref="TargetDao" />
		<property name="companyDao" ref="CompanyDao"/>
		<property name="thumbnailService" ref="ThumbnailService" />
	</bean>
	
	<bean id="RestfulServiceHandler_binding" class="com.agnitas.emm.restful.binding.BindingRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="recipientDao" ref="RecipientDao" />
		<property name="bindingEntryDao" ref="BindingEntryDao" />
		<property name="mailinglistDao" ref="MailinglistDao" />
		<property name="emmActionService" ref="EmmActionService" />
		<property name="configService" ref="ConfigService" />
	</bean>
	
	<bean id="RestfulServiceHandler_actionExecute" class="com.agnitas.emm.restful.action.ActionExecuteRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="emmActionService" ref="EmmActionService" />
	</bean>
	
	<bean id="RestfulServiceHandler_content" class="com.agnitas.emm.restful.content.ContentRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="mailingDao" ref="MailingDao" />
		<property name="dynamicTagDao" ref="DynamicTagDao" />
		<property name="targetDao" ref="TargetDao" />
		<property name="thumbnailService" ref="ThumbnailService" />
	</bean>
	
	<bean id="RestfulQuotaService" class="com.agnitas.emm.util.quota.tokenbucket.Bucket4jQuotaService">
		<property name="bucketManager">
			<bean class="com.agnitas.emm.restful.util.quota.LocalBucketManager">
				<property name="configService" ref="ConfigService" />
				
				<property name="restfulQuotaDao">
					<bean class="com.agnitas.emm.restful.util.quota.dao.RestfulQuotaDaoImpl" parent="_BaseDao" />
				</property>
			</bean>
		</property>
		
		<property name="apiInvocationCosts">
			<bean class="com.agnitas.emm.restful.util.quota.RestfulApiInvocationCostsCache">
				<constructor-arg>
					<bean class="com.agnitas.emm.restful.util.quota.dao.RestfulApiInvocationCostsDaoImpl" parent="_BaseDao" />
				</constructor-arg>
				<constructor-arg ref="ConfigService" />
			</bean>
		</property>
	</bean>
	
	<bean id="ObjectUsageService" class="com.agnitas.emm.core.objectusage.service.impl.ObjectUsageServiceImpl">
		<property name="targetGroupReferencedItemsService" ref="TargetGroupsReferencedItemsService" />
		<property name="profileFieldService" ref="ProfileFieldService" />
	</bean>
	
	<bean id="MailingPropertiesRules" class="com.agnitas.emm.core.mailing.service.impl.MailingPropertiesRulesImpl">
		<property name="maildropService" ref="MaildropService" />
		<property name="mailingDao" ref="MailingDao" />
	</bean>

	<bean id="WysiwygService" class="com.agnitas.emm.core.wysiwyg.service.impl.WysiwygServiceImpl">
		<property name="mailingComponentsService" ref="mailingComponentService" />
	</bean>
	
	<bean id="ThumbnailService" class="com.agnitas.emm.core.thumbnails.service.ThumbnailServiceImpl">
		<property name="mailingComponentDao" ref="MailingComponentDao" />
	</bean>
	
	<bean id="RestfulServiceHandler_profilefield" class="com.agnitas.emm.restful.profilefield.ProfilefieldRestfulServiceHandler">
		<property name="userActivityLogDao" ref="UserActivityLogDao"/>
		<property name="columnInfoService" ref="ColumnInfoService" />
		<property name="profileFieldService" ref="ProfileFieldService" />
		<property name="adminService" ref="AdminService" />
		<property name="profileFieldValidationService" ref="profileValidationService" />
	</bean>
</beans>
